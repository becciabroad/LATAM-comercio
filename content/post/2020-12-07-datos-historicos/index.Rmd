---
title: Datos Historicos del Comercio Exterior de América Latina
author: Rebecca Hoffmann
date: '2020-12-07'
slug: datos-historicos
categories: []
tags: []
draft: false
output:
  blogdown::html_page
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

En este post, querría analizar la evolución del comercio en la región de América Latin utilizando el base de dato de Open Trade Statistics:

### Las libraría utilizadas:

```{r libraries, message=F}
library(tidyverse)
library(tradestatistics)
library(ggplot2)
```
## Los datos
Descargo el base de datos:
I rename the column "reporter_iso" to be able to merge it with the second data frame from Open Trade Statistics:
```{r comercio API 1, message=FALSE}
comercio_mundo_api <- tradestatistics::ots_create_tidy_data(years = 1980:2018, reporters = "all", partners = "all") %>%
  rename(country_iso = 'reporter_iso')
```

From another data base in Open Trade Statistics, I can choose only countries belonging to the continent of The Americas:

```{r comercio API 2, message=FALSE}
countries_LATAM <- tradestatistics::ots_countries %>%
  filter(continent == "Americas") 
```

Merging the two data frames to have the information about the Americas:
```{r comercio LATAM merge, message=FALSE}
comercio_latam_reducido <- merge(x = comercio_mundo_api, y = countries_LATAM,
      by = "country_iso") %>%
  select(country_iso, year, country_fullname_english, export_value_usd) %>%
  drop_na() #limpio los N/A, this excludes a lot of observations/countries - I need to check this again
```

## Transformando los datos
Now I have a data frame including information only for the region of the Americas.
I want to select the variables I want for the visualization of the total export. However, I only want to include information about Latin American countries. So, I also exclude the US and Canada from the analysis:
```{r comercio Americas, message=FALSE}
comercio_latam_modificado <- comercio_latam_reducido %>%
  select(year, 
         country_iso, 
         country_fullname_english, 
         export_value_usd) %>%
  filter(country_iso != "usa", # Excluding the U.S.
         country_iso != "can", # Excluding Canada
         country_iso != "grl", # Excluding Grenland
         country_iso != "vir", # Excluding one observation of US Virgin Islands
         country_iso != "umi") # Excluding "United States Minor Outlying Islands"

```

Before, I graph the results, I want to merge all the Caribbean countries into one category for the Caribbean countries:

## Graficando
```{r comercio LATAM exclude, message=FALSE}
ggplot(comercio_latam_modificado) +
  geom_line(aes(year,
                export_value_usd,
                group = country_fullname_english,
                color = country_fullname_english)) +
  labs(title = "Evolución de exportación en América Latina",
       y = "export en USD",
       x = "Año")+
  theme(legend.position = "bottom")
```