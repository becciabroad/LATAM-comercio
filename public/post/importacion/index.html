---
title: Importación
author: Rebecca Hoffmann
date: '2020-12-07'
slug: importacion
categories: []
tags: []
draft: false
output:
  blogdown::html_page
---

<link href="index_files/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="index_files/anchor-sections/anchor-sections.js"></script>


<p>En el último post sobre los flujos del comercio exterior en América Latina en una perspectiva histórica analisé un poco sobre qué productos principalmente son importados en la región. En este post, quiero analizar este flujos de importación un poco más para entender un poco mejor qué país importa qué tipo de productos.</p>
<p>El post está divido en tres analisis diferentes:</p>
<ol style="list-style-type: decimal">
<li>Un analisis graficando qué países importó más en total en USD en 2018 utilizando un mapa de color del paquete de Rworldmaps.
Existen varios paquetes para realizar mapas, pero me gustó el simple diseño de Rworldmaps. Si aún no tienes Rworldmap installado se puede instalar con este comando:</li>
</ol>
<pre class="r"><code>install.packages(&quot;rworldmap&quot;)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Un analisis mostrando la composición de los productos más importados - también durante el año 2018.</p></li>
<li><p>Finalmente, un analisis sobre qué categoría de producto cada país en la región importa más.</p></li>
</ol>
<div id="las-libraría-utilizadas" class="section level3">
<h3>Las libraría utilizadas:</h3>
<pre class="r"><code>library(tidyverse)
library(tradestatistics) #Para descarga los data frames
library(ggplot2) #Para graficar
library(rworldmap) #Para graficar el mapa del América Latina
library(treemapify) #Para graficar la composición de los productos más importados
library(ggthemes) #Para utilizar el tema especial de ggplot del Economist
library(scales) #Para cambiar el y-axis en los graficos de ggplot a USD </code></pre>
</div>
<div id="preparando-los-datos" class="section level2">
<h2>Preparando los datos</h2>
<div id="descargando-los-datos" class="section level3">
<h3>Descargando los datos</h3>
<p>Cómo en el primer post sobre el comercio exterior, necesito descargar el data frame y modificar el nombre de la columna “reporter_iso” a “country_iso” para poder unirlo con el segundo data frame que separa más fácilmente los países de la región de “las Americas” al resto del mundo:</p>
<pre class="r"><code>comercio_mundo_api &lt;- tradestatistics::ots_create_tidy_data(
  years = 2018, 
  reporters = &quot;all&quot;, 
  partners = &quot;all&quot;, 
  products = &quot;all&quot;) %&gt;%
  rename(country_iso = &#39;reporter_iso&#39;)</code></pre>
<p>Ahora puedo descargar el data frame de Open Trade Statistics sobre los país, y como anteriormente, eligo filtear la región (o continente) de las Americas:</p>
<pre class="r"><code>countries_LATAM &lt;- tradestatistics::ots_countries %&gt;%
  filter(continent == &quot;Americas&quot;) </code></pre>
<p>Después puedo unir los dos data frames para que tenga un que solamente incluye información sobre los país de las Americas:</p>
<pre class="r"><code>comercio_latam &lt;- merge(x = comercio_mundo_api, y = countries_LATAM,
      by = &quot;country_iso&quot;)</code></pre>
</div>
</div>
<div id="mapamundi-de-importaciones" class="section level2">
<h2>Mapamundi de importaciones</h2>
<div id="transformando-los-datos" class="section level3">
<h3>Transformando los datos</h3>
<p>Eligo las variables que necesito para generar el mapa. No obstante, dejo esta información en un nuevo data frame, para que pueda volver a utilizar la información completa sobre importaciones en América Latina en los otros graficos subsequentes.</p>
<pre class="r"><code>comercio_latam_import &lt;- comercio_latam %&gt;%
  select(country_iso,
         reporter_fullname_english,
         import_value_usd)</code></pre>
</div>
</div>
<div id="graficando" class="section level2">
<h2>Graficando</h2>
<p>En primer lugar, tengo que asegurar que la identificación de los países en mi data frame se va a ser entendido por el paquete de Rworldmaps. Después puedo genera el mapa:</p>
<pre class="r"><code>
mapped_data &lt;- joinCountryData2Map(comercio_latam_import, 
                                   joinCode = &quot;NAME&quot;, 
                                   nameJoinColumn = &quot;reporter_fullname_english&quot;)
## 36 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 207 codes from the map weren&#39;t represented in your data

mapCountryData(mapped_data, 
               nameColumnToPlot = &quot;import_value_usd&quot;, 
               mapRegion = &quot;latin america&quot;,
               mapTitle = &quot;Importación 2018&quot;)</code></pre>
<p><img src="index_files/figure-html/comercio%20LATAM%20mapped%20data-1.png" width="672" /></p>
<div id="sum-up" class="section level3">
<h3>Sum-up</h3>
<p>Eso es un montón de rojo!</p>
<p>El mapa parece indicar que la mayoría de los países de la región importan más o menos el mismo nivel. Menos algunos países chicos en America Central, el Caribe, Venezuela, Bolivia y Uruguay, los cuales parecen ser los que menos importan.</p>
<p>Pero la verdad que el mapa nos dice poco sobre los niveles de importación de cada país. Obviamente, se podría empezar a jugar con crear diferentes escales de colores para los differentes niveles de importación en USD, pero la verdad que no me animaba mucho :)</p>
<p>Lo qué sí sería interesante analizar qué tipo de productos son los que más se importaron los paises de América Latin en 2018.</p>
</div>
</div>
<div id="productos-más-importado-por-categoría-en-2018" class="section level2">
<h2>Productos más importado por categoría en 2018</h2>
<p>Entonces, en esta segunda parte de mi post sobre importaciones en América Latina en el año 2018 quiero realizar un analisis sobre las categorías de productos más importados en 2018 utilizando el grafico “treemap” lo cual me gusto porque parece muy inituitivo.</p>
<div id="transformando-los-datos-1" class="section level3">
<h3>Transformando los datos</h3>
<p>En primero lugar, necesito descargar información sobre los productos desde otro base de datos de Open Trade Statistics y unirlo con el data frame que ya tengo sobre la importación en América Latina en el año 2018.</p>
<p>También necesito sacar los países que no corresponde a la región como hice en el primer post. Vale notar que en el analisis arriba del Rworldmaps, la pre-programación del paquete de Rworldmaps automaticamente sacó los países que el paquete no considerable correspondía a la región de América Latina.</p>
<pre class="r"><code>productos_latam &lt;- tradestatistics::ots_products_shortnames %&gt;%
  rename(top_import_product_code = &quot;product_code&quot;)

productos_latam_import &lt;- merge(x = comercio_latam, 
                                y = productos_latam, 
                                by = &#39;top_import_product_code&#39;) %&gt;%
    filter(
         reporter_fullname_english != &quot;USA, Puerto Rico and US Virgin Islands (excludes Virgin Islands until 1981)&quot;,
         reporter_fullname_english != &quot;Canada&quot;,
         reporter_fullname_english != &quot;Greenland&quot;,
         reporter_fullname_english != &quot;Br. Virgin Isds&quot;,
         reporter_fullname_english != &quot;United States Minor Outlying Islands&quot;,
         reporter_fullname_english != &quot;South Georgia and the South Sandwich Islands&quot;) %&gt;%
  drop_na()</code></pre>
<p>Ahora puedo eligir las variables que necesito para generar el treemap y modificar los que quiero modificar. Por ejemplo, necesito sumar el valor importado por producto, y generar una variable que me permite demostrar el porcentaje de cada categoría de productos en relación al total:</p>
<pre class="r"><code>productos_latam_import_2018 &lt;- productos_latam_import %&gt;%
  select(top_import_product_code,
         product_shortname_english,
         import_value_usd) %&gt;%
  group_by(product_shortname_english) %&gt;%
  summarise(import_value_usd = sum(import_value_usd, na.rm = T)) %&gt;%
  ungroup() %&gt;%
  mutate(
    etiquetas = paste0(product_shortname_english, &quot;/&quot;, round(100*import_value_usd/sum(import_value_usd), 2), &quot;%&quot;)) </code></pre>
</div>
<div id="graficando-1" class="section level3">
<h3>Graficando</h3>
<p>Ahora que tengo los datos transformados puedo generar el grapfico:</p>
<pre class="r"><code>ggplot(productos_latam_import_2018, aes(
  area = import_value_usd,
  fill = product_shortname_english,
  label = etiquetas)) +
  geom_treemap() +
  geom_treemap_text(color = &quot;black&quot;,
                    place = &quot;centre&quot;,
                    grow = F,
                    reflow = T) +
  labs(title = &quot;Productos importado en América Latina (2018)&quot;,
       caption = &quot;Fuente: Open Trade Statistics&quot;) +
  theme_economist() +
  theme(plot.title = element_text(size = 12),
    legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/productos%20categoria%20graficar-1.png" width="672" /></p>
</div>
<div id="sum-up-1" class="section level3">
<h3>Sum-up</h3>
<p>Está claro que el producto que más se importa en América Latina en 2018 eran petroleum refineado (74,53%) y autos (12,28%). Eso se alinea muy bien con los hallazgos del breve analisis de la evolución de los flujos de importación en la región.</p>
<p>Lo qué tal vez suprende es que telefonos ocupa un 5,88% de los productos importados y barcos de pasajes y cargo un 4,24%.</p>
<p>No obstante, la tendencia de 2018 subraya lo mencionado en el post anterior: son productos que fabriados y generalmente productos que requiere altos nivels de technología que se importan en América Latina. Eso es preocupante, porqué significa que son productos que la región no produce ellos. La falta de impuestos de trabajo que requiere capacidades técnicos especializados es según los investigadores clave para que América Latina salga de la trampa del medio ingreso.</p>
<p>Obviamente, se podría modificar los nombres de los productos para que se queden en español - pero este te debo :)</p>
</div>
</div>
<div id="categoría-de-productos-más-importado-por-país" class="section level2">
<h2>Categoría de productos más importado por país:</h2>
<p>En esta última parte del post sobre importación en América Latina, quiero analizar qué países importa de qué categoría de producto:</p>
<div id="transformando-los-datos-2" class="section level3">
<h3>Transformando los datos</h3>
<p>En primer lugar, quiero poder cambiar el nombre de Panama, lo cual en el data frama de Open Trade Statistics tiene un nombre muy largo y quiero colapsar Malvinas dentro de la observación de Argentina. Entonces, necesito modificar la columna de “reporter_fullname_english” para que sea un factor.</p>
<pre class="r"><code>import_countries_modificied &lt;- productos_latam_import %&gt;%
  mutate(reporter_fullname_english = as.factor(reporter_fullname_english)) </code></pre>
<p>En segundo lugar, para no tener un gráfico muy largo, elegio sacar todos los pequeños países del Caribe menos Cuba. Después puedo agrupar por país y por producto:</p>
<pre class="r"><code>import_countries_2018 &lt;- import_countries_modificied %&gt;%
  select(reporter_fullname_english,
         import_value_usd,
         product_shortname_english) %&gt;%
  filter(reporter_fullname_english != &quot;Anguilla&quot;,
         reporter_fullname_english != &quot;Antigua and Barbuda&quot;,
         reporter_fullname_english != &quot;Bahamas&quot;,
         reporter_fullname_english != &quot;Bahamas&quot;,
         reporter_fullname_english != &quot;Barbados&quot;,
         reporter_fullname_english != &quot;Belize&quot;,
         reporter_fullname_english != &quot;Bermuda&quot;,
         reporter_fullname_english != &quot;Bouvet Island&quot;,
         reporter_fullname_english != &quot;Cocos Isds&quot;,
         reporter_fullname_english != &quot;Cayman Isds&quot;,
         reporter_fullname_english != &quot;Grenada&quot;,
         reporter_fullname_english != &quot;Guyana&quot;,
         reporter_fullname_english != &quot;Haiti&quot;,
         reporter_fullname_english != &quot;Jamaica&quot;,
         reporter_fullname_english != &quot;Saint Kitts and Nevis (includes Anguilla until 1981)&quot;,
         reporter_fullname_english != &quot;Saint Lucia&quot;,
         reporter_fullname_english != &quot;Montserrat&quot;,
         reporter_fullname_english != &quot;Saint Pierre and Miquelon&quot;,
         reporter_fullname_english != &quot;Suriname&quot;,
         reporter_fullname_english != &quot;Turks and Caicos Isds&quot;,
         reporter_fullname_english != &quot;Trinidad and Tobago&quot;,
         reporter_fullname_english != &quot;Saint Vincent and the Grenadines&quot;) %&gt;%
  mutate(reporter_fullname_english = fct_collapse(reporter_fullname_english,
            &quot;Panama&quot;    = c(&quot;Panama (excludes Panama Canal Zone until 1978)&quot;),
            &quot;Argentina&quot; = c(&quot;Argentina&quot;, 
                             &quot;Falkland Isds (Malvinas)&quot;))) %&gt;% 
  group_by(reporter_fullname_english, 
           product_shortname_english) %&gt;%
  arrange(desc(import_value_usd)) %&gt;%
  drop_na()

tibble(import_countries_2018)
## # A tibble: 19 x 3
##    reporter_fullname_english import_value_usd product_shortname_english
##    &lt;fct&gt;                                &lt;dbl&gt; &lt;chr&gt;                    
##  1 Mexico                        537843736831 Refined Petroleum        
##  2 Brazil                        223647357730 Refined Petroleum        
##  3 Chile                          83743442685 Cars                     
##  4 Argentina                      74043010231 Cars                     
##  5 Colombia                       59519214575 Telephones               
##  6 Peru                           48041977814 Refined Petroleum        
##  7 Panama                         41961011765 Passenger and Cargo Ships
##  8 Ecuador                        28021776726 Refined Petroleum        
##  9 Costa Rica                     19101489498 Refined Petroleum        
## 10 Dominican Rep.                 17851484586 Refined Petroleum        
## 11 Guatemala                      16257301458 Refined Petroleum        
## 12 Paraguay                       16123799211 Telephones               
## 13 Uruguay                        13719463335 Crude Petroleum          
## 14 El Salvador                    13472233660 Refined Petroleum        
## 15 Bolivia                        11588766426 Refined Petroleum        
## 16 Venezuela                      11188570352 Refined Petroleum        
## 17 Honduras                       10587997436 Refined Petroleum        
## 18 Nicaragua                       8482815845 Refined Petroleum        
## 19 Cuba                            6104401480 Poultry Meat</code></pre>
</div>
<div id="graficando-2" class="section level3">
<h3>Graficando</h3>
<p>El tibble da un buena idea de qué países importaron más de los diferentes productos, pero en un grafico se ve mucho mejor:</p>
<pre class="r"><code>ggplot(import_countries_2018, aes(
  x = reporter_fullname_english,
  y = import_value_usd,
  fill = product_shortname_english)) +
    geom_col() +
  labs(
    x = NULL,
    y = NULL,
    fill = NULL,
    title = &quot;Importaciones por producto (2018)&quot;,
    caption = &quot;Fuerte: Open Trade Statistics&quot;) +
  scale_y_continuous(labels = scales::dollar_format()) +
  theme_economist() +
  theme(
    plot.title = element_text(size = 14),
    axis.text.x = element_text(size = 9),
    axis.text.y = element_text(size=9),
    legend.text = element_text(size = 8),
    legend.position = &quot;bottom&quot;) +
  guides(color=guide_legend(&quot;Categoría de producto&quot;)) +
  coord_flip()</code></pre>
<p><img src="index_files/figure-html/comercio%20LATAM%20productos%20graficar-1.png" width="672" /></p>
</div>
<div id="sum-up-2" class="section level3">
<h3>Sum-up</h3>
<p>El grafico muestra claramente, lo que encontramos en la segunda parte de este post: petroleo refinado es el producto más importado en América Latina en 2018. Además, son los dos grandes comerciantes, México y Brasil, quierens importa más. No obstante, muchos países en América Central les sigue con petroleo refinado como su principal producto de importación.</p>
<p>Otras observaciones interesantes: (1) Argentia y Chile son los principales importados de autos. (2) Colombia y Paraguay son los dos países que tiene los telefonos como el principal producto de importación. (3) Panama es el país que principalmente importa los barco que vimos en el analisis arriba - y eso casi tantos barcos como Perú importa petroleo refinado!</p>
</div>
</div>
